---
title: "R Final Project"
author: "Lovro For≈°tner"
date: "11 6 2020"
output: html_document
bibliography: bibliography.bib
link-citations: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(ggplot2)
```

## Video Game Sales Project
<br/>
For my final project in the Data Programming course I chose the data set containing video game sales with data of video game sales in North America, Europe, Japan and the global sales. 

This data set contains a list of video games with sales greater than 100,000 copies. It was generated by a scrape of vgchartz.com. I chose this data set because video games are my hobby and I decided it would be interesting to see some of the details like for example which video games sold the most copies in different parts of the world, what are the top video games sold globally and what platforms take up most of the video game market. I found the data set on the website kaggle.com.


### Introduction of the data

The data comes in the csv format and it is called vgames.csv. There are 11 columns and 11493 unique values of video games that were sold. The dataset contains a list of video games with sales greater than 100,000 copies.

Fields include:

* Rank - Ranking of overall sales

* Name - The games name

* Platform - Platform of the games release (i.e. PC,PS4, etc.)

* Year - Year of the game's release

* Genre - Genre of the game

* Publisher - Publisher of the game

* NA_Sales - Sales in North America (in millions)

* EU_Sales - Sales in Europe (in millions)

* JP_Sales - Sales in Japan (in millions)

* Other_Sales - Sales in the rest of the world (in millions)

* Global_Sales - Total worldwide sales

First I read the .csv file and saved it into the vgsales variable. Here are the first 5 rows with the first 7 columns of the data set where only sales from North America are shown together with the details of the game and the year.

```{r}
vgsales <- read.csv(file = "vgsales.csv")

vgsales5 <- vgsales %>% head(5) %>% select(1:7)

vgsales5
```

<br/>

### Best selling games for individual publishers

Here are the results of the best sold games from unique publishers. These represent the ammount of copies sold for the best game a single publisher produced. It is measured by the global sales.
The ggplot represents the difference between how well the best game from different publishers sold globally.

```{r topgamesGB, message=FALSE}
publishertop <- vgsales %>% group_by(Publisher) %>% top_n(1) %>% select(c(1:5,11)) %>% head(5)
plottopgame <- ggplot(publishertop, aes(x=Publisher, y=Global_Sales)) +geom_jitter(color = "red" ,size=5) +ggtitle("Ammount of money from the best sold games from unique publishers (Top 5)") +labs(x="Name of the game", y="Global Sales in Millions of $")
plottopgame
```
The fact that Wii Sports was bundled with the Wii console in most areas where you could buy this console definitely can't be ignored. They created a game that was accessible to anyone.


### Best selling GameBoy games

Below is the data for top 5 most sold GameBoy games. It was my first console I got as a child, and Pokemon Red was one of the games I owned. Interestingly enough it is the most sold game worldwide for this platform and the only game that comes close to all global sales is Tetris. Pokemon Red/Pokemon Blue made 31.37 millions of copies followed by Tetris with 30.26 millions of copies.


```{r}
bestSellingGB <- vgsales %>% filter(Platform=='GB') %>% arrange(desc(Global_Sales)) %>% select(c(1:4,11)) %>% head(5)
bestSellingGB
```

### Video Game Platforms

<br/>
In the next section I explored the statistics of different platforms the games where made for. I tried to find out what platforms games are made for and which platforms have the best selling video games.
Below are listed all the different platforms for video games available in the data set. There are 31 platforms.
```{r}
#Different Platforms
differenplat <- factor(vgsales$Platform)
levels(differenplat)
```

### Frequency of platforms for all the games versus the top 1000 games

<br/>

I wanted to see how the frequency of platforms for all games compares to the platforms for the top 1000 games and if there is any correlation between the amount of games a platform has and the amount of copies the video games for the specific platform sell.

```{r}
#Top Platform of best selling 1000
bestSelling1000 <- vgsales %>% arrange(desc(Global_Sales)) %>% select(c(1:5,11)) %>% head(1000)

bestSelling1000freq <- bestSelling1000 %>% count(Platform) %>% mutate(percent = n / 1000 * 100) %>% arrange(desc(percent)) %>% head(6)

top1000Plat <- head(bestSelling1000freq,6)
top1000Plat

#Top Platform of all

topPlatform <- count(vgsales, Platform) %>% mutate(percent = round(n / nrow(vgsales) * 100, digits = 2)) %>% arrange(desc(percent))

topPlat <- head(topPlatform,6)
topPlat
```

#### Frequency of platforms for all the games

First I checked out the percentage of platforms for all the video games available in the data set.
Below is the graph for the frequency of platforms of all the games in the data set.

```{r}
ggplot(topPlat, aes(x="", y=percent, fill=Platform)) + 
  geom_bar(width = 1, stat = "identity") + 
  ggtitle("Percentage of platforms for all the games") + 
  coord_polar("y", start = 0) + 
  geom_text(aes(label=paste0(percent,"%")), position = position_stack(vjust=0.5)) +
  theme(axis.text = element_blank(), axis.ticks = element_blank(), panel.grid = element_blank()) +
  labs(x="",y="")
```

#### Frequency of platforms for the top 1000 games

Then I only checked the top 1000 most globally sold games and checked the percentage of platforms.
Below is the graph for the frequency of platforms the top 1000 games in the data set.

```{r}
ggplot(bestSelling1000freq, aes(x="", y=percent, fill=Platform)) + 
  geom_bar(width = 1, stat = "identity") + 
  ggtitle("Percentage of platforms for top 1000 most sold games") + 
  coord_polar("y", start = 0) +
  geom_text(aes(label=paste0(percent,"%")), position = position_stack(vjust=0.5)) + 
  theme(axis.text = element_blank(), axis.ticks = element_blank(), panel.grid = element_blank()) +
  labs(x="",y="")
```


#### Differences in platform percentages

An interesting difference from the two graphs containing the platform percentage is that when you look at the data for all the games sold, Nintendo DS comes in second with 13.02% of gamees right after Playstation 2 with 13.03% of all games. But if you only look at the top 1000 most sold games the Nintendo DS comes in sixth place. It means that for this platform Nintendo made a lot of games, but not that many of them actually rank in the top 1000 sold games in the world. Games for the Nintendo DS only share a 6.7% of all the top 1000 games.


For example Playstation 2 games also had about the same percentage in the dataset with 13.03% of all games in the dataset but in the top 1000 most sold games 16.4% are games made for the Playstation 2 platform.


It's interesting that even though XboX360 is not at the top when you consider all games with 7.62% of all games but when you look at the top 1000 most sold games it's in the second place not that far behind Playstation 2 with 13.1% games made for the Xbox360 platform.

I also thought that in the video game market the majority of sales are for the PC (Personal Computer) and it was very odd to see that only 5.78% of games that sold over a million copies are made for the PC. The PC ranked in the eight place so there is obviously more money in the console market and other platforms.

### Most successful year for video game publishers and developers

I wanted to find out in which year video game publishers made the most money.

Here are the results of the top 5 years:

```{r}
mostSales <- vgsales[complete.cases(vgsales), ] %>% group_by(Year) %>% summarize(Total_Sales = sum(Global_Sales)) %>% arrange(desc(Total_Sales)) %>% rename("Total Sales" = Total_Sales) %>% head(5)
mostSales
```
### Best years for game publishers
<br/>
Below is a graph showing the top ten years for total global sales in a year. The year 2008 was the most successful year for video game developers, followed by the year 2009. The difference between them was only 11.6 millions of copies. 4 top years in video game sales all made over 600 millions of copies.

I would have thought that with the improvement of game developing and the amount of new titles coming in every year the result would be more towards the last years (2017 in the data set) but I was surprised to see that a decade ago game publishers made more money than they do today.

Below is a graph showing the global sales for the top 5 years in which game publishers made the most amount of money:

```{r}
ggplot(mostSales, aes(x=Year, y=`Total Sales`, fill=Year)) + geom_bar(stat = "identity") + coord_flip() + labs(x="Year", y="Total sales in millions of copies") + ggtitle("Top 10 years in total sales in millions of copies (From 1980 to 2017)") + theme_minimal()
```


After I discovered the statistics for most sales in a single year I wanted to find out if there was more games made in the years that brought the most amount of money.
<br/>

```{r}
mostSalesinYear <- vgsales[complete.cases(vgsales), ] %>% group_by(Year) %>% count("Year") %>% arrange(desc(n)) %>% head(7) %>% rename("Ammount of games released" = n)
mostSalesinYear
```



The graph below shows the top 7 years in amount of video games published:

<br/>

```{r}
ggplot(mostSalesinYear, aes(x=Year, y=`Ammount of games released`, fill=Year)) + geom_bar(stat = "identity") + labs(x="Year", y="Total video games published") + ggtitle("Total video games published in a year") + theme_bw()
```

I found out it was true that in the years that publishers made the most amount of money they also released the most amount of games. So it wasn't a couple of successful games that boosted the sales but the amount of games the publishers put out in a year. While there is definitely a correlation between games made and copies sold, in the year 2009 where the most games were made isn't the year that had the most sales (Most sales were in the year 2008) although it is not a huge difference in total global sales.
### The best sold game in North America, Europe and Japan
<br/>

I wanted to find the most sold video game in the three regions of the world represented in the data set: North America, Europe and Japan. I wanted to see if the top sold games are the same or different in other regions of the world.

```{r}
#North America
BestNA <- vgsales %>% arrange(desc(NA_Sales)) %>%  head(1)  %>% select(c(1:4,7))
BestEU <- vgsales %>% arrange(desc(EU_Sales)) %>%  head(1) %>% select(c(1:4,8))
BestJP <- vgsales %>% arrange(desc(JP_Sales)) %>%  head(1)  %>% select(c(1:4,9))
print("North America")
BestNA
#Europe
print("Europe")
BestEU

print("Japan")
BestJP

```
<br/>

Wii sports is the best sold game in both Europe and North America but not in Japan, where the most sold game is Pokemon Red/Pokemon Blue. Wii Sports is a sports video game developed and published by Nintendo for the Wii video game console. The game was released in North America along with the Wii on November 19, 2006, and was released in Japan, Australia, and Europe the following month.The game is a collection of five sports simulations, designed to demonstrate the motion-sensing capabilities of the Wii Remote. The five sports included are tennis, baseball, bowling, golf and boxing.

In north america Wii sports sold copies for a combined staggering amount of 41.29 millions of copies while in Europe it made about 10 million less with 29.02 millions of copies. In Japan Pokemon Red/Pokemon Blue sold 10.22 millions of copies.


### Game genres with the best and least representation
<br/>
For the last data exploration task I wanted to see what the genre representation looks like in the top 5 genres and the 5 least made genres. The bar chart below represents the number of games of the top 5 most represented genres of games in the data set.

```{r}
leastGenre<-count(vgsales,Genre) %>% arrange(n) %>% head(5) %>% rename(Number=n) %>% mutate(Percent=paste0(round((Number/16598),digits=2)*100,"%"))
topGenre <- count(vgsales,Genre) %>% arrange(desc(n)) %>% head(5) %>% rename(Number=n) %>% mutate(Percent=paste0(round((Number/16598),digits=2)*100,"%"))
leastGenre
topGenre
ggplot(topGenre, aes(x=Genre, y=Number, fill=Genre)) + geom_bar(stat = "identity") + ggtitle("Top 5 genres and the ammount of video games in the genre") + theme_minimal()
```


It is interesting that Puzzle and Strategy are the least favorite genre for publishers to produce games for, while action and sports game top the market. Action games take up 20% of the data set which is a pretty big percent of all the games. Following are the genres miscellaneous, role-playing and shooter. I expected sports and shooter games to be at the top as well and sure enough they came in the second and fifth place.

### Game genres that sold the most amount of copies
<br/>

The previous results of the most popular genres made me want to find out if the most popular video game genres also bring in the most amount of global sales, and the following data frame and graph represents this.

```{r}
mostMoneyGenre <- vgsales %>% group_by(Genre) %>% summarise(GlobalSales=sum(Global_Sales))%>% arrange(desc(GlobalSales)) %>% head(5) 
mostMoneyGenre
ggplot(mostMoneyGenre, aes(x=Genre, y=GlobalSales, fill=GlobalSales)) + geom_bar(stat = "identity") + ggtitle("Top 5 genres that made the most money in millions of copies") + theme_minimal() +labs(y="Global Sales in Millions of copies through all the years")
```
It is true that the video game genres with the most amount of games sell the most copies of games. The only difference was that the genre Platform sold more copies than the genre Miscellaneous which was in the top 5 in most games made statistic.


### Conclusion
<br/>

Exploring the data set was interesting and while I am familiar with the market I found out some new things about it that I didn't know before. It might not represent the current state because it only contains years up to 2017 but I believe it might be a very similar situation today. It was interesting to see which platforms, video game publishers and video game genres are popular and which not and what video games or genres people like the most. 


### References

@kaggle:dataset
@rmarkdown:mark
@wiki:wiisports

